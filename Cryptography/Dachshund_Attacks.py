"""
Description
What if d is too small? Connect with nc mercury.picoctf.net 37455.
"""
import owiener
from Crypto.Util.number import long_to_bytes

e = 13435434609068944560557071260164555121140035890282045314392979554027483038270573036428754435526284225541607289490712179046125801743762070853004020832092037812796367220153857533980331711593288680836111327261832393350394747346329824061156514681347163467996184791327230692789782390026273248883524735135578769015
n = 137042738167171962585662924335610230244986110226542195767565916644764340104145313235803242995473286326488552962084672597007178260437191726315992954886218850569002411914113945368397067746144468727303821657520522143529775044875620991065049964398176501198502669233696901484459719064123036925107086295447720833853
c = 24262396360894849007627923806528843200533745143511452695297250624827008612719643620120067833607133648607804534504282172667636593171222517080787320800669186250264700455177352754581567837506943472686761722763939540012370450590258182435121977531889606376783304613228919040546367334577863203004466923668236771460
d = owiener.attack(e, n)  # d = 22224676247110174631805238163723630531428409087036308502614242134460703747319

if d is None:
    print("Failed")
else:
    print("Hacked d= {}".format(d))
  

m = pow(c,d,n)  # 69725092739905610845238448450605396445955360209899851431249991108974083521890297587400085979726050205496503271819862330421887304056374136791728214686727589641759591900134689302287832785170809813833790851359266804127195643447140070898648153156559702948846922871594394100088037839753167544640301232859007198795
M = hex(m)[2:] # 634ab53c2ef7f07becd640aaeb33e6f03545707e656aca003f31a0248990a4c81f1890ffd0fbcc988f2fd46f1648d1cc7fc8861e0151f43ca27d509d1339c9f67b375ddaf4d4bfce1f43cce63f684fc19a3988cd21e43b294c9b3a7443d6d6b44490e44d09fb1896d1565d31541d0269a327e7994c693527d45e9c2030cca64b
# The last part is to convert the hexadecimal string into ASCII characters --> https://www.rapidtables.com/convert/number/hex-to-ascii.html
#FLAG: 
